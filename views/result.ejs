<!DOCTYPE html>
<html>
<head>
    <title>Stack Detected | Voomly</title>
</head>
<body>
    <h1>Detected Stack for:</h1>
    <p><%= repo %></p>
    <h2>â†’ <%= stack %></h2>

    <% if (stack === 'React') { %>
        <form action="/deploy" method="post">
            <input type="hidden" name="repo" value="<%= repo %>">
            <button type="submit">ğŸš€ Deploy This App</button>
        </form>
    <% } else { %>
        <p>Deployment not supported for this stack yet.</p>
    <% } %>
  <h1>ğŸš€ Deployment Logs</h1>
  <pre id="logs"></pre>

  <script>
    const eventSource = new EventSource('/deploy-stream?<%= repo %>');

    eventSource.onmessage = (e) => {
      document.getElementById('logs').textContent += e.data + "\n";
    };

    eventSource.onerror = () => {
      eventSource.close();
      document.getElementById('logs').textContent += '\nâŒ Connection closed.';
    };
  </script>
    <br>
    <a href="/">Check another repo</a>
</body>
</html>
